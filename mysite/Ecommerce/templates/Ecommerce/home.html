{% extends 'base.html' %}
{% block content %}
	

	<style type="text/css">
		p{
			font-size: 12px;
		}

		h2{
			font-size: 20px;
		}

		.product-name{
			height: 26px;
		}

		.product-data{
			width: 100%;
			display: flex;
			flex-direction: column;
			max-height: 180px;
			padding-left: 10px;
			padding-top: 10px;
			padding-bottom: 10px;
			height: 180px;
		}

		.product-data-item{
			height: auto;
		}

		.price-container h2{
			font-size: 40px;
		}

		.product {
			background-color: #f2f2f2;
			border-top: 1px solid #cccccc;
		}

		.button-container {
			display: flex;
			align-items: center;
			justify-content: end;
		}

		.r-sidebar {
			padding-top: 100px;
		}

		.left-sidebar {
			display: flex;
			flex-direction: column;
			min-height: 100%;
			padding: 0;
		}

		.category-list-item{
			height: 30px;
			border: 1px solid black;
		}

		.category-list-header{
			height: 30px;
			border: 1px solid black;
		}

		.product-list-item{
			display: flex;
			flex-direction: row;
			max-height: 180px;
		
			border-bottom: 1px solid #cccccc;
		}

		.product-data-item h2{
			font-size: 24px;
		}

		.kurwa {
			width: 100%;
			max-height: 100%;
		}

		.product-footer {	
			padding-right: 10%;
			display: flex;
			flex-direction: row;
			justify-content: space-between;
			align-items: flex-end;
		}

		.hidden{
			display: none;
		}

		.set-price{
			padding-right: 20px;
			padding-left: 20px;
			padding-top: 40px;
		}

		.price input{
			text-align:center
		}

	</style>
	
	{% for product in object_list %}
	<div class="product-list-item">
		<div class="product-image">
			<img style=" height: 180px; width: auto;" src="{{product.image.url}}">
		</div>
		<div class="kurwa">
			<div class="product-data">
				<div class="product-data-item">
					<h2>{{product.name|title}}</h2>
				</div>
				<div class="product-data-item">
					<p><a href="{% url 'home' category=product.category %}">{{product.category}}</a></p>
				</div>
				<div class="product-data-item">
					<h2>${{product.price}}</h2>
				</div>
				
				<div class="product-data-item">
					<div class="product-footer " >
						<div >
							<br>
							<p>{{product.availability}} left</p>
						</div>
						<div>
							<p></p>
						</div>
						<div>
							<button type="button" class="btn btn-outline-dark">Add To Cart</button>
							{% if user.is_superuser %}
								<button onclick="Delete({{product.id}})" type="button" class="btn btn-outline-danger">Delete</button>
							{% endif %}
						</div>
							
					</div>
				</div>
				
				
			</div>
		</div>

	</div>
		
	{% endfor %}
	<script type="text/javascript">
		function Delete(product_id){
			if(confirm('Are you sure?')){
				var url = "{% url 'delete-product' product_id=0 %}".replace('0', product_id)
				document.location.href= url
			}
		}
	</script>
	
{% endblock content %}

{% block sidebar %}
	<div class="r-sidebar">
		{% if user.is_authenticated and user.is_superuser %}
		<div id="add-product-button">
			<button onclick="CreateProduct()" type="button" class="btn btn-outline-danger">Create new Product</button>	
		</div>

		<div>
			<button onclick="CreateCategory()" type="button" class="btn btn-outline-danger">Create new Category</button>	
		</div>

		{% endif %}
	</div>
	
	
	<script type="text/javascript">
		function CreateProduct(){ //create-product
			var newUrl = "{% url 'create-product' %}"
			document.location.href= newUrl
		}

		function CreateCategory(){ //create-product
			var newUrl = "{% url 'create-category' %}"
			document.location.href= newUrl
		}
	</script>
{% endblock sidebar %}

{% block leftsidebar %}
	<link rel="stylesheet" href="//code.jquery.com/ui/1.13.2/themes/base/jquery-ui.css">
	<script src="https://code.jquery.com/jquery-3.6.0.js"></script>
	<script src="https://code.jquery.com/ui/1.13.2/jquery-ui.js"></script>


	<div class="left-sidebar">
		<div class="category-list-header">
			<h2><a href="#" onclick="toggleCategories()">Categories:</a></h2>
		</div>
		<div id="category-list" class="hidden">
			{% for category in categories %}
				<div class="category-list-item">
					<h2><a href="{% url 'home' category=category.name %}">{{category.name}}</a></h2>
				</div>
			{% endfor %}
		</div>
	

	

	
		<div class="set-price">
			<div class="price">
				<p>
					<label for="amount">Price range:</label>
					<br>
					<input type="text" id="amount" readonly style="border:0; color:#f6931f; font-weight:bold;">
				</p>
			</div>
			
			<div id="slider-range"></div>
			<button onclick="check_priceRange()" > check</button>
		</div>
	</div>
 

	<script>
		$( function() {
			let params = new URLSearchParams(location.search);
			let min_price = params.get('price_from')
			let max_price = params.get('price_to')

			if(max_price == null){
				max_price = 500;
			}
			if(min_price == null){
				min_price = 0;
			}

			console.log(max_price)
			$( "#slider-range" ).slider({
				range: true,
				min:0,
				
				max: 500,
				values: [ min_price, max_price ],
				slide: function( event, ui ){
					$( "#amount" ).val( "$" + ui.values[ 0 ] + " - $" + ui.values[ 1 ] );
				}
			});
			$( "#amount" ).val( "$" + $( "#slider-range" ).slider( "values", 0 ) +
			" - $" + $( "#slider-range" ).slider( "values", 1 ) );
		});

		function check_priceRange() {
			var a = $( "#slider-range" ).slider("values", 0);
			var b = $( "#slider-range" ).slider("values", 1);
			var link = "?price_from=a&price_to=b".replace("a", a).replace("b", b)
			window.location.href = link
			console.log(a)
			console.log(b)
		}

	</script>

	<script type="text/javascript">
		var categoriesStatus = false
		var categories = document.getElementById('category-list')

		function toggleCategories(){
			console.log(categories)
			console.log(categoriesStatus)
			if(categoriesStatus == false){
				categoriesStatus=true
				categories.classList.remove('hidden')
			}
			else{
				categoriesStatus=false
				categories.classList.add('hidden')
			}
		}
	</script>
{% endblock leftsidebar %}


